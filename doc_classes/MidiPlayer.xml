<?xml version="1.0" encoding="UTF-8" ?>
<class name="MidiPlayer" inherits="Node" version="4.1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/godotengine/godot/master/doc/class.xsd">
	<brief_description>
		A MIDI file player node that synthesizes audio using SoundFont instruments.
	</brief_description>
	<description>
		[MidiPlayer] loads and plays MIDI files using CPU-based SoundFont synthesis (via TinySoundFont). It provides real-time audio output, playback control, and tempo/volume management.

		Features:
		- Load MIDI files ([MidiFileResource]) and SoundFont instruments ([SoundFontResource])
		- Play, pause, resume, and stop playback
		- Seek to any position in the track
		- Adjust playback speed (tempo) and master volume
		- Export audio to WAV files
		- Monitor playback position and state

		Example usage:
		[codeblock]
		var player = MidiPlayer.new()
		player.set_soundfont(soundfont_resource)
		player.load_midi(midi_resource)
		player.play()
		add_child(player)
		[/codeblock]
	</description>
	<tutorials>
	</tutorials>
	<methods>
		<method name="export_to_wav">
			<return type="int" enum="Error" />
			<param index="0" name="wav_path" type="String" />
			<param index="1" name="max_duration_ms" type="int" default="0" />
			<description>
				Exports the currently loaded MIDI to a WAV file. If [param max_duration_ms] is 0, exports until the track ends naturally. Returns [constant OK] on success, or an error code on failure.
			</description>
		</method>
		<method name="get_current_position_ms">
			<return type="int" />
			<description>
				Returns the current playback position in milliseconds.
			</description>
		</method>
		<method name="get_duration_ms">
			<return type="int" />
			<description>
				Returns the total duration of the loaded MIDI in milliseconds. Returns 0 if no MIDI is loaded.
			</description>
		</method>
		<method name="get_playback_speed">
			<return type="float" />
			<description>
				Returns the current playback speed multiplier (1.0 = normal speed).
			</description>
		</method>
		<method name="get_volume_db">
			<return type="float" />
			<description>
				Returns the current master volume in decibels.
			</description>
		</method>
		<method name="is_playing">
			<return type="bool" />
			<description>
				Returns [code]true[/code] if the MIDI is currently playing.
			</description>
		</method>
		<method name="load_midi">
			<return type="bool" />
			<param index="0" name="midi_resource" type="MidiFileResource" />
			<description>
				Loads a MIDI file from a [MidiFileResource]. Returns [code]true[/code] on success, [code]false[/code] on failure.
			</description>
		</method>
		<method name="pause">
			<return type="void" />
			<description>
				Pauses playback. Call [method resume] to continue from the same position.
			</description>
		</method>
		<method name="play">
			<return type="void" />
			<description>
				Starts playback from the current position (or from the beginning if not yet started).
			</description>
		</method>
		<method name="resume">
			<return type="void" />
			<description>
				Resumes playback from a paused state.
			</description>
		</method>
		<method name="seek_to_ms">
			<return type="void" />
			<param index="0" name="position_ms" type="int" />
			<description>
				Seeks to a specific position in milliseconds within the loaded MIDI.
			</description>
		</method>
		<method name="set_playback_speed">
			<return type="void" />
			<param index="0" name="speed" type="float" />
			<description>
				Sets the playback speed multiplier (default: 1.0). Values &gt; 1.0 speed up playback; &lt; 1.0 slow it down.
			</description>
		</method>
		<method name="set_soundfont">
			<return type="bool" />
			<param index="0" name="soundfont_resource" type="SoundFontResource" />
			<description>
				Sets the SoundFont to use for synthesis. Returns [code]true[/code] on success. Must be called before [method load_midi] for proper instrument playback.
			</description>
		</method>
		<method name="set_volume_db">
			<return type="void" />
			<param index="0" name="volume_db" type="float" />
			<description>
				Sets the master volume in decibels (default: 0.0). Typical range is -80 to 0 dB.
			</description>
		</method>
		<method name="stop">
			<return type="void" />
			<description>
				Stops playback and resets the playback position to the beginning.
			</description>
		</method>
	</methods>
	<signals>
		<signal name="finished">
			<description>
				Emitted when the MIDI playback reaches the end and stops automatically.
			</description>
		</signal>
	</signals>
	<constants>
	</constants>
</class>
